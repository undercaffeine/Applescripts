# UNRAR
# created by Lucas Padilha (lucas.padilha@undercaffeine.com)
# Script for automate the file extracting process

tell application "Finder"
	# get the file that you want to unrar
	set fileAlias to the selection as alias
	set folderAlias to the (folder of fileAlias) as alias
	set folderPath to (the POSIX path of folderAlias)
	set filePath to (the POSIX path of fileAlias)
	display dialog filePath
	# create a vetor with files inside the unrar file
	set filesInside to do shell script "/usr/local/bin/unrar v " & quoted form of filePath
	set AppleScript's text item delimiters to return
	# create a selection box with files inside
	set myList to text items in filesInside
	set chosen to choose from list myList with multiple selections allowed
	if chosen is not equal to false then
		# extract only the files selected
		do shell script "cd " & quoted form of folderPath & "; /usr/local/bin/unrar e " & quoted form of filePath & " " & chosen
	end if
end tell
